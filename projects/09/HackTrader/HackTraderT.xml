<tokens>
<keyword> class </keyword>
<identifier> HackTrader </identifier>
<symbol> { </symbol>
<keyword> field </keyword>
<identifier> OrderBook </identifier>
<identifier> book </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<identifier> MarketMaker </identifier>
<identifier> player </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<identifier> OptionsPricer </identifier>
<identifier> pricer </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<identifier> PriceEngine </identifier>
<identifier> engine </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<identifier> TradeHasher </identifier>
<identifier> hasher </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<identifier> UI </identifier>
<identifier> ui </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<identifier> RNG </identifier>
<identifier> rng </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<keyword> int </keyword>
<identifier> currentRound </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<keyword> int </keyword>
<identifier> totalRounds </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<keyword> int </keyword>
<identifier> difficulty </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<keyword> int </keyword>
<identifier> botFlowRate </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<keyword> int </keyword>
<identifier> botSizeMax </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<keyword> int </keyword>
<identifier> tickDelayMs </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<keyword> boolean </keyword>
<identifier> gameRunning </identifier>
<symbol> ; </symbol>
<keyword> field </keyword>
<identifier> Array </identifier>
<identifier> pnlHistory </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> TOTAL_ROUNDS </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> TICK_DELAY_MS </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> START_PRICE </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> INIT_QUOTE_SIZE </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> MAX_POSITION </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> VOL_MULTIPLIER </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOOK_TICK_SIZE </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOOK_BASE_QTY </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOOK_INIT_LEVELS </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOT_MKT_ORDER_PROB </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOT_LIMIT_OFFSET_RANGE </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOT_LIMIT_OFFSET_MIN </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> MIN_BOOK_LEVELS </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> REPLENISH_TARGET </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> REPLENISH_SPACING </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> REPLENISH_QTY_RANGE </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> REPLENISH_QTY_BASE </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> VOL_EASY </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> VOL_MEDIUM </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> VOL_HARD </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> FLOW_RATE_EASY </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> FLOW_RATE_MEDIUM </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> FLOW_RATE_HARD </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOT_SIZE_EASY </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOT_SIZE_MEDIUM </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> BOT_SIZE_HARD </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> SPREAD_EASY </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> SPREAD_MEDIUM </identifier>
<symbol> ; </symbol>
<keyword> static </keyword>
<keyword> int </keyword>
<identifier> SPREAD_HARD </identifier>
<symbol> ; </symbol>
<keyword> function </keyword>
<keyword> void </keyword>
<identifier> init </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> TOTAL_ROUNDS </identifier>
<symbol> = </symbol>
<integerConstant> 30 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> TICK_DELAY_MS </identifier>
<symbol> = </symbol>
<integerConstant> 200 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> START_PRICE </identifier>
<symbol> = </symbol>
<integerConstant> 1000 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> INIT_QUOTE_SIZE </identifier>
<symbol> = </symbol>
<integerConstant> 2 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> MAX_POSITION </identifier>
<symbol> = </symbol>
<integerConstant> 20 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> VOL_MULTIPLIER </identifier>
<symbol> = </symbol>
<integerConstant> 10 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOOK_TICK_SIZE </identifier>
<symbol> = </symbol>
<integerConstant> 10 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOOK_BASE_QTY </identifier>
<symbol> = </symbol>
<integerConstant> 3 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOOK_INIT_LEVELS </identifier>
<symbol> = </symbol>
<integerConstant> 5 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOT_MKT_ORDER_PROB </identifier>
<symbol> = </symbol>
<integerConstant> 3 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOT_LIMIT_OFFSET_RANGE </identifier>
<symbol> = </symbol>
<integerConstant> 30 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOT_LIMIT_OFFSET_MIN </identifier>
<symbol> = </symbol>
<integerConstant> 5 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> MIN_BOOK_LEVELS </identifier>
<symbol> = </symbol>
<integerConstant> 3 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> REPLENISH_TARGET </identifier>
<symbol> = </symbol>
<integerConstant> 4 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> REPLENISH_SPACING </identifier>
<symbol> = </symbol>
<integerConstant> 10 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> REPLENISH_QTY_RANGE </identifier>
<symbol> = </symbol>
<integerConstant> 3 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> REPLENISH_QTY_BASE </identifier>
<symbol> = </symbol>
<integerConstant> 2 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> VOL_EASY </identifier>
<symbol> = </symbol>
<integerConstant> 2 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> VOL_MEDIUM </identifier>
<symbol> = </symbol>
<integerConstant> 4 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> VOL_HARD </identifier>
<symbol> = </symbol>
<integerConstant> 7 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> FLOW_RATE_EASY </identifier>
<symbol> = </symbol>
<integerConstant> 40 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> FLOW_RATE_MEDIUM </identifier>
<symbol> = </symbol>
<integerConstant> 60 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> FLOW_RATE_HARD </identifier>
<symbol> = </symbol>
<integerConstant> 80 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOT_SIZE_EASY </identifier>
<symbol> = </symbol>
<integerConstant> 3 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOT_SIZE_MEDIUM </identifier>
<symbol> = </symbol>
<integerConstant> 5 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> BOT_SIZE_HARD </identifier>
<symbol> = </symbol>
<integerConstant> 7 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> SPREAD_EASY </identifier>
<symbol> = </symbol>
<integerConstant> 10 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> SPREAD_MEDIUM </identifier>
<symbol> = </symbol>
<integerConstant> 10 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> SPREAD_HARD </identifier>
<symbol> = </symbol>
<integerConstant> 15 </integerConstant>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> function </keyword>
<keyword> void </keyword>
<identifier> setTotalRounds </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> r </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> TOTAL_ROUNDS </identifier>
<symbol> = </symbol>
<identifier> r </identifier>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> function </keyword>
<keyword> void </keyword>
<identifier> setTickDelay </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> ms </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> TICK_DELAY_MS </identifier>
<symbol> = </symbol>
<identifier> ms </identifier>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> constructor </keyword>
<identifier> HackTrader </identifier>
<identifier> new </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> diff </identifier>
<symbol> , </symbol>
<keyword> int </keyword>
<identifier> seed </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> vol </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> initSpread </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> startPrice </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> difficulty </identifier>
<symbol> = </symbol>
<identifier> diff </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> totalRounds </identifier>
<symbol> = </symbol>
<identifier> TOTAL_ROUNDS </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> tickDelayMs </identifier>
<symbol> = </symbol>
<identifier> TICK_DELAY_MS </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> currentRound </identifier>
<symbol> = </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> gameRunning </identifier>
<symbol> = </symbol>
<keyword> true </keyword>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> startPrice </identifier>
<symbol> = </symbol>
<identifier> START_PRICE </identifier>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> diff </identifier>
<symbol> = </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> vol </identifier>
<symbol> = </symbol>
<identifier> VOL_EASY </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> botFlowRate </identifier>
<symbol> = </symbol>
<identifier> FLOW_RATE_EASY </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> botSizeMax </identifier>
<symbol> = </symbol>
<identifier> BOT_SIZE_EASY </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> initSpread </identifier>
<symbol> = </symbol>
<identifier> SPREAD_EASY </identifier>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> diff </identifier>
<symbol> = </symbol>
<integerConstant> 2 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> vol </identifier>
<symbol> = </symbol>
<identifier> VOL_MEDIUM </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> botFlowRate </identifier>
<symbol> = </symbol>
<identifier> FLOW_RATE_MEDIUM </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> botSizeMax </identifier>
<symbol> = </symbol>
<identifier> BOT_SIZE_MEDIUM </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> initSpread </identifier>
<symbol> = </symbol>
<identifier> SPREAD_MEDIUM </identifier>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> vol </identifier>
<symbol> = </symbol>
<identifier> VOL_HARD </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> botFlowRate </identifier>
<symbol> = </symbol>
<identifier> FLOW_RATE_HARD </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> botSizeMax </identifier>
<symbol> = </symbol>
<identifier> BOT_SIZE_HARD </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> initSpread </identifier>
<symbol> = </symbol>
<identifier> SPREAD_HARD </identifier>
<symbol> ; </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
<keyword> let </keyword>
<identifier> pnlHistory </identifier>
<symbol> = </symbol>
<identifier> Array </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<identifier> totalRounds </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> rng </identifier>
<symbol> = </symbol>
<identifier> RNG </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<identifier> seed </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> book </identifier>
<symbol> = </symbol>
<identifier> OrderBook </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> player </identifier>
<symbol> = </symbol>
<identifier> MarketMaker </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<identifier> initSpread </identifier>
<symbol> , </symbol>
<identifier> INIT_QUOTE_SIZE </identifier>
<symbol> , </symbol>
<identifier> MAX_POSITION </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> pricer </identifier>
<symbol> = </symbol>
<identifier> OptionsPricer </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<identifier> startPrice </identifier>
<symbol> , </symbol>
<identifier> vol </identifier>
<symbol> * </symbol>
<identifier> VOL_MULTIPLIER </identifier>
<symbol> , </symbol>
<identifier> totalRounds </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> engine </identifier>
<symbol> = </symbol>
<identifier> PriceEngine </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<identifier> startPrice </identifier>
<symbol> , </symbol>
<identifier> vol </identifier>
<symbol> , </symbol>
<integerConstant> 0 </integerConstant>
<symbol> , </symbol>
<identifier> rng </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> hasher </identifier>
<symbol> = </symbol>
<identifier> TradeHasher </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> ui </identifier>
<symbol> = </symbol>
<identifier> UI </identifier>
<symbol> . </symbol>
<identifier> new </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> initializeBook </identifier>
<symbol> ( </symbol>
<identifier> startPrice </identifier>
<symbol> , </symbol>
<identifier> BOOK_TICK_SIZE </identifier>
<symbol> , </symbol>
<identifier> BOOK_BASE_QTY </identifier>
<symbol> , </symbol>
<identifier> BOOK_INIT_LEVELS </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> updateQuotes </identifier>
<symbol> ( </symbol>
<identifier> startPrice </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<keyword> this </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> method </keyword>
<keyword> void </keyword>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> pricer </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> engine </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> hasher </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> pnlHistory </identifier>
<symbol> . </symbol>
<identifier> dispose </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> Memory </identifier>
<symbol> . </symbol>
<identifier> deAlloc </identifier>
<symbol> ( </symbol>
<keyword> this </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> method </keyword>
<keyword> int </keyword>
<identifier> run </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> key </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> spotPrice </identifier>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> clearScreen </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> spotPrice </identifier>
<symbol> = </symbol>
<identifier> engine </identifier>
<symbol> . </symbol>
<identifier> getPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> pricer </identifier>
<symbol> . </symbol>
<identifier> recalculate </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> , </symbol>
<identifier> totalRounds </identifier>
<symbol> - </symbol>
<identifier> currentRound </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawTitle </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStaticLabels </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawOrderBook </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawGreeks </identifier>
<symbol> ( </symbol>
<identifier> pricer </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawPosition </identifier>
<symbol> ( </symbol>
<identifier> player </identifier>
<symbol> , </symbol>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawTradeLogPanel </identifier>
<symbol> ( </symbol>
<identifier> hasher </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawControls </identifier>
<symbol> ( </symbol>
<identifier> currentRound </identifier>
<symbol> , </symbol>
<identifier> totalRounds </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> Game started! Manage your quotes. </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> while </keyword>
<symbol> ( </symbol>
<identifier> gameRunning </identifier>
<symbol> &amp; </symbol>
<symbol> ( </symbol>
<identifier> currentRound </identifier>
<symbol> &lt; </symbol>
<identifier> totalRounds </identifier>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> key </identifier>
<symbol> = </symbol>
<identifier> Keyboard </identifier>
<symbol> . </symbol>
<identifier> keyPressed </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> processInput </identifier>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<symbol> ~ </symbol>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> while </keyword>
<symbol> ( </symbol>
<symbol> ~ </symbol>
<symbol> ( </symbol>
<identifier> Keyboard </identifier>
<symbol> . </symbol>
<identifier> keyPressed </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> = </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
<keyword> do </keyword>
<identifier> engine </identifier>
<symbol> . </symbol>
<identifier> tick </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> spotPrice </identifier>
<symbol> = </symbol>
<identifier> engine </identifier>
<symbol> . </symbol>
<identifier> getPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> pricer </identifier>
<symbol> . </symbol>
<identifier> recalculate </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> , </symbol>
<identifier> totalRounds </identifier>
<symbol> - </symbol>
<identifier> currentRound </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> updateQuotes </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getMidPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> generateBotFlow </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> checkPlayerFills </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> replenishBook </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> currentRound </identifier>
<symbol> = </symbol>
<identifier> currentRound </identifier>
<symbol> + </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> pnlHistory </identifier>
<symbol> [ </symbol>
<identifier> currentRound </identifier>
<symbol> - </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ] </symbol>
<symbol> = </symbol>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> getTotalPnL </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawOrderBook </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawGreeks </identifier>
<symbol> ( </symbol>
<identifier> pricer </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawPosition </identifier>
<symbol> ( </symbol>
<identifier> player </identifier>
<symbol> , </symbol>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawTradeLogPanel </identifier>
<symbol> ( </symbol>
<identifier> hasher </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawControls </identifier>
<symbol> ( </symbol>
<identifier> currentRound </identifier>
<symbol> , </symbol>
<identifier> totalRounds </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> Sys </identifier>
<symbol> . </symbol>
<identifier> wait </identifier>
<symbol> ( </symbol>
<identifier> tickDelayMs </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawGameOver </identifier>
<symbol> ( </symbol>
<identifier> player </identifier>
<symbol> , </symbol>
<identifier> engine </identifier>
<symbol> . </symbol>
<identifier> getPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> , </symbol>
<identifier> currentRound </identifier>
<symbol> , </symbol>
<identifier> pnlHistory </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> getTotalPnL </identifier>
<symbol> ( </symbol>
<identifier> engine </identifier>
<symbol> . </symbol>
<identifier> getPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> method </keyword>
<keyword> void </keyword>
<identifier> processInput </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> key </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> filled </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> spotPrice </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> spotPrice </identifier>
<symbol> = </symbol>
<identifier> engine </identifier>
<symbol> . </symbol>
<identifier> getPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 66 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> filled </identifier>
<symbol> = </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> submitMarketOrder </identifier>
<symbol> ( </symbol>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> getQuoteSize </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> , </symbol>
<keyword> true </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> filled </identifier>
<symbol> &gt; </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> onFill </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getFillPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> , </symbol>
<identifier> filled </identifier>
<symbol> , </symbol>
<keyword> true </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> logTrade </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getFillPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> , </symbol>
<identifier> filled </identifier>
<symbol> , </symbol>
<keyword> true </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> Manual BUY filled! </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> No asks to buy from! </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 83 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> filled </identifier>
<symbol> = </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> submitMarketOrder </identifier>
<symbol> ( </symbol>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> getQuoteSize </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> , </symbol>
<keyword> false </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> filled </identifier>
<symbol> &gt; </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> onFill </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getFillPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> , </symbol>
<identifier> filled </identifier>
<symbol> , </symbol>
<keyword> false </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> logTrade </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getFillPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> , </symbol>
<identifier> filled </identifier>
<symbol> , </symbol>
<keyword> false </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> Manual SELL filled! </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> No bids to sell to! </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 87 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> widenSpread </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> updateQuotes </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getMidPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> Spread widened. </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 78 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> narrowSpread </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> updateQuotes </identifier>
<symbol> ( </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getMidPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> Spread narrowed. </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 43 </integerConstant>
<symbol> ) </symbol>
<symbol> | </symbol>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 61 </integerConstant>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> increaseSize </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> Quote size increased. </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 45 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> decreaseSize </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> drawStatus </identifier>
<symbol> ( </symbol>
<stringConstant> Quote size decreased. </stringConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> key </identifier>
<symbol> = </symbol>
<integerConstant> 81 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> gameRunning </identifier>
<symbol> = </symbol>
<keyword> false </keyword>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> method </keyword>
<keyword> void </keyword>
<identifier> generateBotFlow </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> roll </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> botQty </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> boolean </keyword>
<identifier> botBuy </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> limitPrice </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> offset </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> roll </identifier>
<symbol> = </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<integerConstant> 100 </integerConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> roll </identifier>
<symbol> &gt; </symbol>
<identifier> botFlowRate </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> let </keyword>
<identifier> botBuy </identifier>
<symbol> = </symbol>
<symbol> ( </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<integerConstant> 2 </integerConstant>
<symbol> ) </symbol>
<symbol> = </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> botQty </identifier>
<symbol> = </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<identifier> botSizeMax </identifier>
<symbol> ) </symbol>
<symbol> + </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> roll </identifier>
<symbol> = </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<integerConstant> 10 </integerConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> roll </identifier>
<symbol> &lt; </symbol>
<identifier> BOT_MKT_ORDER_PROB </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> submitMarketOrder </identifier>
<symbol> ( </symbol>
<identifier> botQty </identifier>
<symbol> , </symbol>
<identifier> botBuy </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> offset </identifier>
<symbol> = </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<identifier> BOT_LIMIT_OFFSET_RANGE </identifier>
<symbol> ) </symbol>
<symbol> + </symbol>
<identifier> BOT_LIMIT_OFFSET_MIN </identifier>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> botBuy </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> limitPrice </identifier>
<symbol> = </symbol>
<identifier> spotPrice </identifier>
<symbol> - </symbol>
<identifier> offset </identifier>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> addLiquidity </identifier>
<symbol> ( </symbol>
<identifier> limitPrice </identifier>
<symbol> , </symbol>
<identifier> botQty </identifier>
<symbol> , </symbol>
<keyword> true </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> limitPrice </identifier>
<symbol> = </symbol>
<identifier> spotPrice </identifier>
<symbol> + </symbol>
<identifier> offset </identifier>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> addLiquidity </identifier>
<symbol> ( </symbol>
<identifier> limitPrice </identifier>
<symbol> , </symbol>
<identifier> botQty </identifier>
<symbol> , </symbol>
<keyword> false </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> method </keyword>
<keyword> void </keyword>
<identifier> checkPlayerFills </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> roll </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> fillQty </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> boolean </keyword>
<identifier> fillBuy </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> fillPrice </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> roll </identifier>
<symbol> = </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<integerConstant> 100 </integerConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> roll </identifier>
<symbol> &gt; </symbol>
<symbol> ( </symbol>
<identifier> botFlowRate </identifier>
<symbol> / </symbol>
<integerConstant> 2 </integerConstant>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> let </keyword>
<identifier> fillBuy </identifier>
<symbol> = </symbol>
<symbol> ( </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<integerConstant> 2 </integerConstant>
<symbol> ) </symbol>
<symbol> = </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> fillQty </identifier>
<symbol> = </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> getQuoteSize </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ) </symbol>
<symbol> + </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> fillBuy </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> fillPrice </identifier>
<symbol> = </symbol>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> getBidPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> fillPrice </identifier>
<symbol> &gt; </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> onFill </identifier>
<symbol> ( </symbol>
<identifier> fillPrice </identifier>
<symbol> , </symbol>
<identifier> fillQty </identifier>
<symbol> , </symbol>
<keyword> true </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> logTrade </identifier>
<symbol> ( </symbol>
<identifier> fillPrice </identifier>
<symbol> , </symbol>
<identifier> fillQty </identifier>
<symbol> , </symbol>
<keyword> true </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> fillPrice </identifier>
<symbol> = </symbol>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> getAskPrice </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> fillPrice </identifier>
<symbol> &gt; </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> player </identifier>
<symbol> . </symbol>
<identifier> onFill </identifier>
<symbol> ( </symbol>
<identifier> fillPrice </identifier>
<symbol> , </symbol>
<identifier> fillQty </identifier>
<symbol> , </symbol>
<keyword> false </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> logTrade </identifier>
<symbol> ( </symbol>
<identifier> fillPrice </identifier>
<symbol> , </symbol>
<identifier> fillQty </identifier>
<symbol> , </symbol>
<keyword> false </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> method </keyword>
<keyword> void </keyword>
<identifier> replenishBook </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> spotPrice </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> bidCount </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> askCount </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> i </identifier>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> bidCount </identifier>
<symbol> = </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getBidCount </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> askCount </identifier>
<symbol> = </symbol>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> getAskCount </identifier>
<symbol> ( </symbol>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> bidCount </identifier>
<symbol> &lt; </symbol>
<identifier> MIN_BOOK_LEVELS </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> i </identifier>
<symbol> = </symbol>
<identifier> bidCount </identifier>
<symbol> ; </symbol>
<keyword> while </keyword>
<symbol> ( </symbol>
<identifier> i </identifier>
<symbol> &lt; </symbol>
<identifier> REPLENISH_TARGET </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> addLiquidity </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> - </symbol>
<symbol> ( </symbol>
<symbol> ( </symbol>
<identifier> i </identifier>
<symbol> + </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ) </symbol>
<symbol> * </symbol>
<identifier> REPLENISH_SPACING </identifier>
<symbol> ) </symbol>
<symbol> , </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<identifier> REPLENISH_QTY_RANGE </identifier>
<symbol> ) </symbol>
<symbol> + </symbol>
<identifier> REPLENISH_QTY_BASE </identifier>
<symbol> , </symbol>
<keyword> true </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> i </identifier>
<symbol> = </symbol>
<identifier> i </identifier>
<symbol> + </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ; </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> askCount </identifier>
<symbol> &lt; </symbol>
<identifier> MIN_BOOK_LEVELS </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> i </identifier>
<symbol> = </symbol>
<identifier> askCount </identifier>
<symbol> ; </symbol>
<keyword> while </keyword>
<symbol> ( </symbol>
<identifier> i </identifier>
<symbol> &lt; </symbol>
<identifier> REPLENISH_TARGET </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> do </keyword>
<identifier> book </identifier>
<symbol> . </symbol>
<identifier> addLiquidity </identifier>
<symbol> ( </symbol>
<identifier> spotPrice </identifier>
<symbol> + </symbol>
<symbol> ( </symbol>
<symbol> ( </symbol>
<identifier> i </identifier>
<symbol> + </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ) </symbol>
<symbol> * </symbol>
<identifier> REPLENISH_SPACING </identifier>
<symbol> ) </symbol>
<symbol> , </symbol>
<identifier> rng </identifier>
<symbol> . </symbol>
<identifier> nextInRange </identifier>
<symbol> ( </symbol>
<identifier> REPLENISH_QTY_RANGE </identifier>
<symbol> ) </symbol>
<symbol> + </symbol>
<identifier> REPLENISH_QTY_BASE </identifier>
<symbol> , </symbol>
<keyword> false </keyword>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> let </keyword>
<identifier> i </identifier>
<symbol> = </symbol>
<identifier> i </identifier>
<symbol> + </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ; </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> method </keyword>
<keyword> void </keyword>
<identifier> logTrade </identifier>
<symbol> ( </symbol>
<keyword> int </keyword>
<identifier> price </identifier>
<symbol> , </symbol>
<keyword> int </keyword>
<identifier> qty </identifier>
<symbol> , </symbol>
<keyword> boolean </keyword>
<identifier> isBuy </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> hashVal </identifier>
<symbol> ; </symbol>
<keyword> var </keyword>
<keyword> int </keyword>
<identifier> side </identifier>
<symbol> ; </symbol>
<keyword> if </keyword>
<symbol> ( </symbol>
<identifier> isBuy </identifier>
<symbol> ) </symbol>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> side </identifier>
<symbol> = </symbol>
<integerConstant> 1 </integerConstant>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> else </keyword>
<symbol> { </symbol>
<keyword> let </keyword>
<identifier> side </identifier>
<symbol> = </symbol>
<integerConstant> 0 </integerConstant>
<symbol> ; </symbol>
<symbol> } </symbol>
<keyword> let </keyword>
<identifier> hashVal </identifier>
<symbol> = </symbol>
<identifier> hasher </identifier>
<symbol> . </symbol>
<identifier> hash </identifier>
<symbol> ( </symbol>
<identifier> price </identifier>
<symbol> , </symbol>
<identifier> qty </identifier>
<symbol> , </symbol>
<identifier> side </identifier>
<symbol> , </symbol>
<identifier> currentRound </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> do </keyword>
<identifier> ui </identifier>
<symbol> . </symbol>
<identifier> addTradeToLog </identifier>
<symbol> ( </symbol>
<identifier> price </identifier>
<symbol> , </symbol>
<identifier> qty </identifier>
<symbol> , </symbol>
<identifier> isBuy </identifier>
<symbol> , </symbol>
<identifier> hashVal </identifier>
<symbol> ) </symbol>
<symbol> ; </symbol>
<keyword> return </keyword>
<symbol> ; </symbol>
<symbol> } </symbol>
<symbol> } </symbol>
</tokens>
